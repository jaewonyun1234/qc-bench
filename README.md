# qc-bench

Benchmark lab for 1D potentials (ISW / HO / Double well) comparing ansatzes and noise impacts.

## Quickstart

```bash
source qc-bench-venv/bin/activate
pip install -r requirements.txt
pip install -e .
```

Run a config (writes/updates `results/runs.parquet`):

```bash
python -m qcbench.runner configs/isw.yaml
```

Then open `notebooks/01_figures.ipynb` to plot from the results table.


## Hamiltonian Variational Ansatz (HVA) in this project

This benchmark compares two VQE ansatz families:

* **efficient_su2 (hardware-efficient ansatz)**: generic layers of single-qubit rotations + entanglers.
* **HVA (Hamiltonian Variational Ansatz)**: physics-informed layers built from the Hamiltonian’s structure.

The goal is practical and measurable:

> For simple 1D quantum systems (Infinite Square Well / Harmonic Oscillator / Double Well), which ansatz gives the best first 5 energies (E0–E4) for the least circuit cost, and how do shots + noise degrade performance?

---

## VQE reminder (what we optimize)

VQE searches for parameters (\theta) that minimize the energy expectation value:
[
E(\theta) = \langle \psi(\theta)|H|\psi(\theta)\rangle,
\quad
|\psi(\theta)\rangle = U(\theta)|\psi_0\rangle.
]

Important: the state does **not** “naturally relax” to the ground state just because gates look like time evolution. Ground-state behavior comes from the **variational minimization** (the optimizer), not from physical cooling.

---

## What HVA is (one sentence)

**HVA is a VQE ansatz where the circuit is made from exponentials of Hamiltonian components**, typically alternating between “potential-like” and “kinetic-like” pieces.

---

## HVA design used here

For our 1D problems, after finite-difference discretization the Hamiltonian naturally splits into:
[
H = T + V
]

* (T): kinetic energy (finite-difference approximation to (-\frac{\hbar^2}{2m}\frac{d^2}{dx^2}))
* (V): potential energy (diagonal in the position/grid basis)

We use the standard plain-HVA layer structure:
[
U(\theta) = \prod_{\ell=1}^{p} \Big(e^{-i\alpha_\ell V}; e^{-i\beta_\ell T}\Big).
]

Each layer has only **two parameters** ((\alpha_\ell,\beta_\ell)), repeated for `reps = p` layers.

---

## Why HVA can be efficient (what “efficient” means here)

### 1) Parameter efficiency

Plain HVA uses **2 parameters per layer**, independent of qubit count.
By contrast, hardware-efficient circuits often use many parameters per qubit per layer.

Fewer parameters can mean:

* smaller search space,
* more stable optimization across seeds,
* good performance at low depth (problem-dependent, not guaranteed).

### 2) Physics-guided “search directions”

A small perturbation of a gate generated by (H_k) is:
[
e^{-i\epsilon H_k}|\psi\rangle \approx |\psi\rangle - i\epsilon,H_k|\psi\rangle.
]
So locally, the ansatz can move in directions spanned by:
[
{-iH_1|\psi\rangle,; -iH_2|\psi\rangle,;\dots}.
]
HVA chooses (H_k) from physically meaningful operators (like (T) and (V)), so the variational search stays within a structured family of states tied to the problem’s physics, rather than arbitrary rotations.

### 3) Energy can actually change under HVA layers

Even though each factor looks like “time evolution,” the variational energy is not conserved unless you evolve under (H) itself. If you apply a unitary generated by (H_k) and measure the energy of the full (H), then:
[
E(\theta)=\langle \psi|e^{i\theta H_k}He^{-i\theta H_k}|\psi\rangle
]
and
[
\frac{dE}{d\theta}\Big|_{\theta=0} = i\langle \psi|[H_k,H]|\psi\rangle.
]
So if ([H_k,H]\neq 0), tuning (\theta) can move the energy up or down—this is what makes the variational search meaningful.

---

## Symmetry note: parity for symmetric 1D potentials

For many 1D potentials we benchmark (HO, symmetric double well, centered ISW), the potential satisfies:
[
V(x)=V(-x).
]
This implies **parity** (P) is a symmetry of the Hamiltonian:
[
[H,P]=0.
]
Therefore energy eigenstates can be chosen to have definite parity (even or odd). In symmetric 1D systems, low-lying eigenstates typically alternate parity:

* (E_0) even, (E_1) odd, (E_2) even, …

If an ansatz (and initialization) is restricted to a single symmetry sector, it cannot represent eigenstates in the other sector. Since this benchmark targets (E_0)–(E_4), we avoid baking in a single-parity restriction by default unless explicitly running “sector” experiments.

---

## Summary

* **HVA** builds (U(\theta)) from exponentials of Hamiltonian pieces (here: alternating (V) and (T)).
* **Efficiency** comes from fewer parameters and a physics-guided search family.
* Symmetries like **parity** can structure the search (useful conceptually and sometimes practically), especially for symmetric 1D potentials.
* The benchmark evaluates accuracy (E0–E4), circuit cost, and robustness under shots + noise in a reproducible way.
